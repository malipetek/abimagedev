const data = {
  "products": [
    {
      "id": 7945551708379,
      "title": "650C 45mm Micro Wheelset",
      "body_html": "<p><em>This is a demonstration store. You can purchase products like this from <a href=\"https://www.purefixcycles.com\" target=\"_blank\">Pure Fix Cycles</a></em></p><p>Designed for speed and style in a more compact package, these Pure Fix double-walled aluminum wheelsets are size 650C with a 45mm rim depth, front and rear. Our wheels include name-brand and laser-etched, 120 mm KT Quando hubs. Our rear wheels include flip-flop hubs with a pre-attached 16T fixed cog along with a 16T freewheel cog for single-speed riding. Front and rear wheels feature 32 spokes each and all wheelsets include nylon rim-strips to protect against sharp edges and prevent tube puncture.</p>\n<p>We recommend using any style of 650C tire (tires and tubes not included).<br> <br> List of Specs:</p>\n<ul>\n<li>650C</li>\n<li>45mm rim depth</li>\n<li>Double-walled aluminum</li>\n<li>120mm KT Quando hubs</li>\n<li>Non-sealed</li>\n<li>Flip-flop rear hub</li>\n<li>Comes with pre-attached 16T fixed and freewheel cog</li>\n<li>32 spokes per wheel</li>\n<li>Includes nylon rim strips</li>\n<li>3.5 lbs per wheel</li>\n<li>\n<span style=\"font-size: 14px; line-height: 1.5;\">Perfect for our </span><a href=\"http://purefixcycles.com/collections/micro-series\" style=\"font-size: 14px; line-height: 1.5;\">Micro Line</a>\n</li>\n</ul>",
      "vendor": "Pure Fix Cycles",
      "product_type": "Wheelsets",
      "created_at": "2023-01-20T17:53:13+03:00",
      "handle": "650c-micro-wheelset",
      "updated_at": "2023-05-13T23:06:38+03:00",
      "published_at": "2023-01-20T17:53:08+03:00",
      "template_suffix": null,
      "status": "active",
      "published_scope": "web",
      "tags": "650C, 650C Wheelsets, Black, Blue, Micro, Orange, Wheels, Wheelset, Wheelsets and Accessories, White",
      "admin_graphql_api_id": "gid://shopify/Product/7945551708379",
      "variants": [
        {
          "id": 43881468231899,
          "product_id": 7945551708379,
          "title": "Orange",
          "price": "130.00",
          "sku": "Orange Wheels 650c",
          "position": 1,
          "inventory_policy": "deny",
          "compare_at_price": null,
          "fulfillment_service": "manual",
          "inventory_management": "shopify",
          "option1": "Orange",
          "option2": null,
          "option3": null,
          "created_at": "2023-01-20T17:53:14+03:00",
          "updated_at": "2023-01-20T17:53:14+03:00",
          "taxable": true,
          "barcode": "741360638785",
          "grams": 13608,
          "image_id": 39064949391579,
          "weight": 30.0005,
          "weight_unit": "lb",
          "inventory_item_id": 45978105118939,
          "inventory_quantity": 8,
          "old_inventory_quantity": 8,
          "requires_shipping": true,
          "admin_graphql_api_id": "gid://shopify/ProductVariant/43881468231899"
        },
        {
          "id": 43881468264667,
          "product_id": 7945551708379,
          "title": "Black",
          "price": "130.00",
          "sku": "Black Wheels 650c",
          "position": 2,
          "inventory_policy": "deny",
          "compare_at_price": null,
          "fulfillment_service": "manual",
          "inventory_management": "shopify",
          "option1": "Black",
          "option2": null,
          "option3": null,
          "created_at": "2023-01-20T17:53:14+03:00",
          "updated_at": "2023-01-20T17:53:14+03:00",
          "taxable": true,
          "barcode": "741360638761",
          "grams": 13608,
          "image_id": 39064949424347,
          "weight": 30.0005,
          "weight_unit": "lb",
          "inventory_item_id": 45978105151707,
          "inventory_quantity": 4,
          "old_inventory_quantity": 4,
          "requires_shipping": true,
          "admin_graphql_api_id": "gid://shopify/ProductVariant/43881468264667"
        },
        {
          "id": 43881468297435,
          "product_id": 7945551708379,
          "title": "Blue",
          "price": "130.00",
          "sku": "Blue Wheels 650c",
          "position": 3,
          "inventory_policy": "deny",
          "compare_at_price": null,
          "fulfillment_service": "manual",
          "inventory_management": "shopify",
          "option1": "Blue",
          "option2": null,
          "option3": null,
          "created_at": "2023-01-20T17:53:14+03:00",
          "updated_at": "2023-01-20T17:53:14+03:00",
          "taxable": true,
          "barcode": "741360638792",
          "grams": 13608,
          "image_id": 39064949457115,
          "weight": 30.0005,
          "weight_unit": "lb",
          "inventory_item_id": 45978105184475,
          "inventory_quantity": 1,
          "old_inventory_quantity": 1,
          "requires_shipping": true,
          "admin_graphql_api_id": "gid://shopify/ProductVariant/43881468297435"
        },
        {
          "id": 43881468330203,
          "product_id": 7945551708379,
          "title": "White",
          "price": "130.00",
          "sku": "White Wheels 650c",
          "position": 4,
          "inventory_policy": "deny",
          "compare_at_price": null,
          "fulfillment_service": "manual",
          "inventory_management": "shopify",
          "option1": "White",
          "option2": null,
          "option3": null,
          "created_at": "2023-01-20T17:53:14+03:00",
          "updated_at": "2023-01-20T17:53:14+03:00",
          "taxable": true,
          "barcode": "741360638778",
          "grams": 13608,
          "image_id": 39064949489883,
          "weight": 30.0005,
          "weight_unit": "lb",
          "inventory_item_id": 45978105217243,
          "inventory_quantity": 15,
          "old_inventory_quantity": 15,
          "requires_shipping": true,
          "admin_graphql_api_id": "gid://shopify/ProductVariant/43881468330203"
        }
      ],
      "options": [
        {
          "id": 10066760007899,
          "product_id": 7945551708379,
          "name": "Color",
          "position": 1,
          "values": [
            "Orange",
            "Black",
            "Blue",
            "White"
          ]
        }
      ],
      "images": [
        {
          "id": 39064949391579,
          "product_id": 7945551708379,
          "position": 1,
          "created_at": "2023-01-20T17:53:14+03:00",
          "updated_at": "2023-01-20T17:53:14+03:00",
          "alt": "Orange",
          "width": 1200,
          "height": 800,
          "src": "https://cdn.shopify.com/s/files/1/0621/4444/6683/products/650_orange_web.jpg?v=1674226394",
          "variant_ids": [
            43881468231899
          ],
          "admin_graphql_api_id": "gid://shopify/ProductImage/39064949391579"
        },
        {
          "id": 39064949424347,
          "product_id": 7945551708379,
          "position": 2,
          "created_at": "2023-01-20T17:53:14+03:00",
          "updated_at": "2023-01-20T17:53:14+03:00",
          "alt": "Black",
          "width": 1200,
          "height": 800,
          "src": "https://cdn.shopify.com/s/files/1/0621/4444/6683/products/650_black_web.jpg?v=1674226394",
          "variant_ids": [
            43881468264667
          ],
          "admin_graphql_api_id": "gid://shopify/ProductImage/39064949424347"
        },
        {
          "id": 39064949457115,
          "product_id": 7945551708379,
          "position": 3,
          "created_at": "2023-01-20T17:53:14+03:00",
          "updated_at": "2023-01-20T17:53:14+03:00",
          "alt": "Blue",
          "width": 1200,
          "height": 800,
          "src": "https://cdn.shopify.com/s/files/1/0621/4444/6683/products/650_blue_web.jpg?v=1674226394",
          "variant_ids": [
            43881468297435
          ],
          "admin_graphql_api_id": "gid://shopify/ProductImage/39064949457115"
        },
        {
          "id": 39064949489883,
          "product_id": 7945551708379,
          "position": 4,
          "created_at": "2023-01-20T17:53:14+03:00",
          "updated_at": "2023-01-20T17:53:14+03:00",
          "alt": "White",
          "width": 1200,
          "height": 800,
          "src": "https://cdn.shopify.com/s/files/1/0621/4444/6683/products/650_white_web.jpg?v=1674226394",
          "variant_ids": [
            43881468330203
          ],
          "admin_graphql_api_id": "gid://shopify/ProductImage/39064949489883"
        }
      ],
      "image": {
        "id": 39064949391579,
        "product_id": 7945551708379,
        "position": 1,
        "created_at": "2023-01-20T17:53:14+03:00",
        "updated_at": "2023-01-20T17:53:14+03:00",
        "alt": "Orange",
        "width": 1200,
        "height": 800,
        "src": "https://cdn.shopify.com/s/files/1/0621/4444/6683/products/650_orange_web.jpg?v=1674226394",
        "variant_ids": [
          43881468231899
        ],
        "admin_graphql_api_id": "gid://shopify/ProductImage/39064949391579"
      }
    }
  ]
};
import directus from './directus.js';

(async () => {
  const $trigger = {
    "payload": {
      "id": "offline_liquivelte.myshopify.com",
      "shop": "liquivelte.myshopify.com",
      "state": "076673222518053",
      "isOnline": false,
      "accessToken": "shpua_cdec80c09c5776d9118e2648bc666217",
      "scope": "write_products,write_files,write_script_tags",
      "shop_id": 62144446683
    }
  };
  const products = data.products;
  try {
    await directus.items('products')
      .createMany(products
        .map(p => ({
          ...p,
          shop_id: $trigger.payload.shop_id,
          image: null,
          images: null,
          variants: null
        })));

    await directus.items('products').updateBatch(products
      .map(p => ({
        ...p,
        variants: null,
      })));
      
    await directus.items('products').updateBatch(products
      .map(p => ({
        ...p,
      })));
  } catch (e) {
    console.log(e);
  }
})();